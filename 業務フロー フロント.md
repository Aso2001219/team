@startuml
opt 未登録
ユーザー -> Webサーバー : ユーザー登録(情報を入力)
Webサーバー -> DBサーバー : ユーザー登録
DBサーバー -> DBサーバー : 登録処理
DBサーバー -> Webサーバー : 登録結果

alt 登録成功
Webサーバー -> ユーザー : 登録成功
else 登録失敗
Webサーバー -> ユーザー : 登録失敗
end
end

ユーザー -> Webサーバー : ログイン(ID・PASS入力)
Webサーバー -> DBサーバー : ログイン照会
DBサーバー -> DBサーバー : ログイン処理
DBサーバー -> Webサーバー : 認証結果

alt ログイン成功
Webサーバー -> ユーザー : 認証結果(成功)

opt 会員情報編集
ユーザー -> Webサーバー : 変更する情報を入力
Webサーバー -> DBサーバー :変更情報
DBサーバー -> DBサーバー : 変更処理
DBサーバー -> Webサーバー : 編集結果
Webサーバー -> ユーザー : 編集結果
end

ユーザー -> Webサーバー : 商品一覧
Webサーバー -> DBサーバー : 商品一覧
DBサーバー -> DBサーバー : 商品一覧
DBサーバー -> Webサーバー : 商品一覧出力処理
Webサーバー -> ユーザー : 商品一覧出力処理

ユーザー -> Webサーバー : 検索(商品名)
Webサーバー -> DBサーバー : 検索処理(商品名)
DBサーバー -> DBサーバー : 検索処理
DBサーバー -> Webサーバー : 検索結果
Webサーバー -> ユーザー : 検索結果

opt 商品クリック(詳細表示)
ユーザー -> Webサーバー : 商品クリック
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> Webサーバー : 照会結果
Webサーバー -> ユーザー : 詳細情報表示

opt お気に入りボタンクリック
ユーザー -> Webサーバー : 商品詳細でお気に入りボタンをクリック
Webサーバー -> DBサーバー :お気に入りに追加
DBサーバー -> DBサーバー : お気に入りに追加
DBサーバー -> Webサーバー : お気に入りとして反映
Webサーバー -> ユーザー : お気に入りとして反映
end

opt 戻る機能
ユーザー -> Webサーバー : 戻る処理
end
alt 在庫あり
opt カートに商品を追加
ユーザー -> Webサーバー : カートに追加
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> DBサーバー : カートに追加された分の商品数を減らす

opt 商品清算
ユーザー -> Webサーバー : 商品を清算する
Webサーバー -> DBサーバー :商品を清算する
DBサーバー -> DBサーバー : 商品を清算する
DBサーバー -> Webサーバー : 結果を表示
Webサーバー -> ユーザー : 結果を表示
end

end
else 在庫なし
ユーザー -> Webサーバー : カートに追加
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> Webサーバー : 照会結果
Webサーバー -> ユーザー : 在庫結果
DBサーバー -> 発注業者 : 商品の発注
end

opt 退会する
ユーザー -> Webサーバー : 退会処理を行う
Webサーバー -> DBサーバー : 退会処理を行う
DBサーバー -> DBサーバー : 登録情報を消去
DBサーバー -> Webサーバー : 登録情報を消去
Webサーバー -> ユーザー : 登録情報を消去
end

end
else ログイン失敗

Webサーバー -> ユーザー : 認証結果(失敗)
end
ユーザー -> Webサーバー : ログアウト
Webサーバー -> DBサーバー : ログアウト
DBサーバー -> DBサーバー : ログアウト処理
DBサーバー -> Webサーバー : 認証結果
Webサーバー -> ユーザー : 認証結果
@enduml
