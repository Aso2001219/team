```
@startuml
opt 商品クリック(詳細表示)
ユーザー -> Webサーバー : 商品クリック
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> Webサーバー : 照会結果
Webサーバー -> ユーザー : 詳細情報表示

opt お気に入りボタンクリック
ユーザー -> Webサーバー : 商品詳細でお気に入りボタンをクリック
Webサーバー -> DBサーバー :お気に入りに追加
DBサーバー -> DBサーバー : お気に入りに追加
DBサーバー -> Webサーバー : お気に入りとして反映
Webサーバー -> ユーザー : お気に入りとして反映
end

opt お気に入り
ユーザー -> Webサーバー : お気に入り一覧
Webサーバー -> DBサーバー : お気に入り一覧
DBサーバー -> DBサーバー : お気に入り一覧を出力処理
DBサーバー -> Webサーバー : お気に入り一覧を出力処理
Webサーバー -> ユーザー : お気に入り一覧を出力処理
end

opt カートに商品を追加
ユーザー -> Webサーバー : カートに追加
Webサーバー -> DBサーバー : 商品照会
DBサーバー -> DBサーバー : カートに追加された分の商品数を減らす
DBサーバー -> Webサーバー : カート内照会結果
Webサーバー -> ユーザー : カート内照会結果
end

opt 商品購入
ユーザー -> Webサーバー : カートから購入
ユーザー -> Webサーバー : 商品詳細から購入
Webサーバー -> DBサーバー : 商品情報、登録情報
DBサーバー -> DBサーバー : 商品情報、登録情報
DBサーバー -> Webサーバー : 購入結果表示
Webサーバー -> ユーザー : 購入結果表示
end

opt 商品購入履歴
ユーザー -> Webサーバー : 購入履歴を閲覧
Webサーバー -> DBサーバー : 購入履歴照会
DBサーバー -> DBサーバー : 購入履歴照会
DBサーバー -> Webサーバー : 購入履歴出力
Webサーバー -> ユーザー : 購入履歴出力
end

opt 退会する
ユーザー -> Webサーバー : 退会処理を行う
Webサーバー -> DBサーバー : 退会処理を行う
DBサーバー -> DBサーバー : 登録情報を消去
DBサーバー -> Webサーバー : 登録情報を消去
Webサーバー -> ユーザー : 登録情報を消去
end

else ログイン失敗

Webサーバー -> ユーザー : 認証結果(失敗)
end
ユーザー -> Webサーバー : ログアウト
Webサーバー -> DBサーバー : ログアウト
DBサーバー -> DBサーバー : ログアウト処理
DBサーバー -> Webサーバー : 認証結果
Webサーバー -> ユーザー : 認証結果
@enduml
```
